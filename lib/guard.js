// Generated by CoffeeScript 1.6.3
(function() {
  guard.emit('miss', req.url, CACHE[req.url]);

  res.cache = function(_arg) {
    var lastModified;
    lastModified = (_arg != null ? _arg : {}).lastModified;
    if (lastModified != null) {
      this.set('Last-Modified', new Date(lastModified).toUTCString());
    }
    CACHE[req.url] = this._headers;
    if (typeof invalidator !== "undefined" && invalidator !== null) {
      return invalidator.once('invalidate', function() {
        return guard.invalidate(req.url);
      });
    }
  };

  next();

}).call(this);
